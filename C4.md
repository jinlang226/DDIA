# preview
* 服务端（server-side），客户端（client-side），向后兼容 (backward compatibility)，向前兼容（难） (forward compatibility)


* 几种编码数据的格式，包括 JSON，XML，Protocol Buffers，Thrift和Avro

* **具象状态传输（REST）** 和 **远程过程调用（RPC）**，以及**消息传递系统**（如Actor和消息队列）。

# 编码数据的格式
1. 内存：data structure
2. 将数据写入文件：encode

# 语言特定的格式
采用语言内置编码通常是一个坏主意

# JSON, XML, and Binary Variants
XML经常被批评为过于冗长和不必要的复杂。 JSON倍受欢迎，主要由于它在Web浏览器中的内置支持（通过成为JavaScript的一个子集）以及相对于XML的简单性。 CSV是另一种流行的与语言无关的格式，尽管功能较弱。、
* XML和CSV不能区分数字和字符串（除非引用外部模式）。 JSON虽然区分字符串和数字，但不区分整数和浮点数，而且不能指定精度。
* 大于$2^{53}$的整数不能在IEEE 754双精度浮点数中精确表示，因此在使用浮点数（例如JavaScript）的语言进行分析时，这些数字会变得不准确。


# 二进制
## Thrift与Protocol Buffers
## 字段标签和模式演变
## Avro
 它是作为Hadoop的一个子项目在2009年开始的，因为Thrift不适合Hadoop的用例
* 作者模式
    * 当应用程序想要编码一些数据（将其写入文件或数据库，通过网络发送等）时，它使用它知道的任何版本的模式编码数据，例如，架构可能被编译到应用程序中。这被称为作者的模式。
    * 有很多记录的大文件
    * 支持独立写入的记录的数据库
    * 通过网络连接发送记录
* 读者模式
    * 当一个应用程序想要解码一些数据（从一个文件或数据库读取数据，从网络接收数据等）时，它希望数据在某个模式中，这就是读者的模式。这是应用程序代码所依赖的模式，在应用程序的构建过程中，代码可能是从该模式生成的。
* 模式演变规则
    * 兼容性
        * 为了保持兼容性，您只能添加或删除具有默认值的字段
* 动态生成的模式
    * 架构不包含任何标签号码
    * 数据导出过程不需要注意模式的改变 - 每次运行时都可以简单地进行模式转换。
* Avro为静态类型编程语言提供了可选的代码生成功能

# 数据流的类型
## 数据流动之间常见方式：
* 通过数据库
* 通过服务调用
* 通过异步消息传递
## 数据库中的数据流
* 数据库前后兼容
## 归档存储
## 服务中的数据流：REST与RPC
### Web服务
* 当服务使用HTTP作为底层通信协议时，可称之为Web服务
    * 运行在用户设备上的客户端应用程序
    * 一种服务向同一组织拥有的另一项服务提出请求，这些服务通常位于同一数据中心内，作为面向服务/微型架构的一部分。 
    * 一种服务通过互联网向不同组织所拥有的服务提出请求。这用于不同组织后端系统之间的数据交换。
* 方法
    * REST
        * 强调简单的数据格式，使用URL来标识资源，并使用HTTP功能进行缓存控制，身份验证和内容类型协商
    * SOAP
        * 于制作网络API请求的基于XML的协议
        * 独立于HTTP，并避免使用大多数HTTP功能
* 远程过程调用（RPC）的问题
    *  RPC模型试图向远程网络服务发出请求，看起来与在同一进程中调用编程语言中的函数或方法相同
    *  缺陷
    * 远程请求与本地函数调用不同
    *  RPC框架的主要重点在于同一组织拥有的服务之间的请求，通常在同一数据中心内。
## 消息传递中的数据流
* 消息代理 over RPC
* 分布式的Actor框架